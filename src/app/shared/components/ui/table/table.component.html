<div class="table-wrapper relative">
  @if (data !== null) {
    <table class="styled-table border-surface" appScrollAnimate>
      @if (data.length > 0) {
        <thead class="border-surface-3 bg-background-2 rounded-sm">
          <tr class="font-bold">
            @for (col of columns; track col) {
              <th>
                <button
                  (click)="orderBy(col.key)"
                  class="sort-button"
                  [ngClass]="{ 'active-sort': isColumnSorted(col.key) }"
                  >
                  <span class="label">{{ col.label }}</span>
                  <span class="arrow-group">
                    <svg
                      class="arrow-icon up"
                      viewBox="0 0 24 24"
                [ngClass]="{
                  active: isColumnSorted(col.key) && isAscending,
                  inactive: !isColumnSorted(col.key) || !isAscending,
                }"
                      >
                      <path d="M7 14l5-5 5 5" stroke-linecap="round" stroke-linejoin="round" />
                    </svg>
                    <svg
                      class="arrow-icon down"
                      viewBox="0 0 24 24"
                [ngClass]="{
                  active: isColumnSorted(col.key) && isAscending === false,
                  inactive: !isColumnSorted(col.key) || isAscending === true,
                }"
                      >
                      <path d="M7 10l5 5 5-5" stroke-linecap="round" stroke-linejoin="round" />
                    </svg>
                  </span>
                </button>
              </th>
            }
            @if (actionsTemplate) {
              <th>Acciones</th>
            }
          </tr>
        </thead>
      }
      <tbody>
        @for (row of data; track row) {
          <tr>
            @for (col of columns; track col) {
              <td>
                @if (col.link) {
                  <app-text-link
                    [text]="row[col.key]"
                    [routerLink]="'/solicitar-auto'"
                    [color]="'primary'"
                    [queryParams]="getQueryParams(col, row)"
                  ></app-text-link>
                } @else {
                  {{ row[col.key] }}
                }
              </td>
            }
            @if (actionsTemplate) {
              <td>
                <ng-container
                  *ngTemplateOutlet="actionsTemplate; context: { $implicit: row }"
                ></ng-container>
              </td>
            }
          </tr>
        }
        @if (data.length === 0) {
          <tr>
            <td [attr.colspan]="columns.length + (actionsTemplate ? 1 : 0)">No hay datos</td>
          </tr>
        }
      </tbody>
    </table>
  }
</div>
